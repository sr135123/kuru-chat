<!DOCTYPE html>
<html lang="en">
<head>
  <link rel="shortcut icon" href="main.ico" type="image/x-icon">
  <meta charset="UTF-8">
  <title>ì¿ ë£¨ì¿ ë£¨ì˜ ìºë¦­í„° AI</title>
  <script type="module">
    //0.4
    const base_sets = `
    * í”„ë¡¬í”„íŠ¸ê°€ ì—†ì„ ê²½ìš°ì—ëŠ” ì¹œêµ¬ê°™ì€ ë§íˆ¬ë¥¼ ì‚¬ìš©
    * {{}}ì•ˆì— ë“¤ì–´ê°€ ìˆëŠ” í…ìŠ¤íŠ¸ëŠ” ì´ë¯¸ì§€ë¼ê³  ê°„ì£¼í•œë‹¤.
      * ì‚¬ìš© ê°€ëŠ¥í•œ ì´ë¯¸ì§€
        * hoshino_ai
        * main_icon
    * Gemini:, You: ë“±ì€ ë§¥ë½ì„ ì´í•´í•˜ëŠ” ìš©ë„ì´ë¯€ë¡œ ì‹¤ì œ ì±„íŒ…ì— ì…ë ¥í•˜ì§€ ì•ŠëŠ”ë‹¤. ì¦‰, ë©”ì„¸ì§€ë§Œ ì…ë ¥í•œë‹¤.
    * ì´ì „ì— í–ˆë˜ ëŒ€í™”ë¥¼ ë°˜ë³µí•˜ëŠ” í–‰ìœ„ëŠ” í•˜ì§€ ì•ŠëŠ”ë‹¤.
    * ë‹¹ì‹ ì€ ìƒí™©ì— ë§ê²Œ cmd[ëª…ë ¹ì–´(ë³€ìˆ˜)] í˜•ì‹ì˜ ëª…ë ¹ì–´ë¥¼ ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤.
      * ì˜ˆì‹œ: cmd[bg(night)]
    * ëª…ë ¹ì–´ ë³€ìˆ˜ëŠ” '', "" ì—†ì´ ê·¸ëƒ¥ ì‚¬ìš©í•œë‹¤.
    `
    const text_commands = `
    * bg
      * basic
      * night 
    `

    const chatDisplay = document.getElementById("chatDisplay");
    const userInput = document.getElementById("userInput");
    const chatList = document.getElementById("chatList");
    const hasUnsavedChanges = false;

    let chatHistory = [];
    let isWaitingForResponse = false;
    let currentChatTitle = null;

    userInput.addEventListener("keydown", (e) => {
      if (e.key === "Enter" && !e.shiftKey) {
        e.preventDefault();
        if (!isWaitingForResponse) {
          sendMessage();
        }
      }
    });

    document.getElementById("newChat").addEventListener("click", () => {
      chatHistory = [];
      currentChatTitle = null;
      chatDisplay.innerHTML = "";
    });

    function saveChat() {
      const savedChats = JSON.parse(localStorage.getItem("savedChats") || "{}");
      savedChats[currentChatTitle] = chatHistory;
      localStorage.setItem("savedChats", JSON.stringify(savedChats));
      updateChatList();
    }

    function updateChatList() {
      const chatListElem = document.getElementById("chatList");
      chatListElem.innerHTML = "";
      const savedChats = JSON.parse(localStorage.getItem("savedChats") || "{}");
      for (const name in savedChats) {
        const container = document.createElement("div");
        container.id = "chatContainer"
        container.style.display = 'flex';
        container.style.alignItems = 'center';
        container.style.marginBottom = '10px';

        const button = document.createElement("button");
        button.textContent = name;
        button.style.flex = '1';
        button.style.height = '40px';
        button.style.borderRadius = '12px';
        button.style.fontSize = '14px';
        button.style.background = 'rgba(255, 253, 150, 0.2)';
        button.disabled = isWaitingForResponse;
        button.onclick = () => {
          if (!isWaitingForResponse) loadChat(name);
        };

        const renameBtn = document.createElement("span");
        renameBtn.textContent = 'âœï¸';
        renameBtn.style.marginLeft = '6px';
        renameBtn.style.cursor = 'pointer';
        renameBtn.title = "ì´ë¦„ ë³€ê²½";
        renameBtn.onclick = () => renameChat(name);

        const deleteBtn = document.createElement("span");
        deleteBtn.textContent = 'ğŸ—‘ï¸';
        deleteBtn.style.marginLeft = '6px';
        deleteBtn.style.cursor = 'pointer';
        deleteBtn.title = "ì‚­ì œ";
        deleteBtn.onclick = () => confirmDelete(name);

        const settingsBtn = document.createElement("span");
        settingsBtn.textContent = 'âš™ï¸';
        settingsBtn.style.marginLeft = '6px';
        settingsBtn.style.cursor = 'pointer';
        settingsBtn.title = "í”„ë¡¬í”„íŠ¸ ì„¤ì •";
        settingsBtn.onclick = () => setPrompt(name);

        container.appendChild(button);
        container.appendChild(renameBtn);
        container.appendChild(settingsBtn);
        container.appendChild(deleteBtn);
        chatListElem.appendChild(container);
      }
    }

    function renameChat(oldName) {
      const newName = prompt("ìƒˆë¡œìš´ ëŒ€í™” ì´ë¦„ì„ ì…ë ¥í•˜ì„¸ìš”:", oldName);
      if (!newName || newName === oldName) return;
      const savedChats = JSON.parse(localStorage.getItem("savedChats") || "{}");
      if (savedChats[newName]) {
        alert("ì´ë¯¸ ì¡´ì¬í•˜ëŠ” ì´ë¦„ì…ë‹ˆë‹¤.");
        return;
      }
      savedChats[newName] = savedChats[oldName];
      delete savedChats[oldName];
      localStorage.setItem("savedChats", JSON.stringify(savedChats));

      const prompts = JSON.parse(localStorage.getItem("chatPrompts") || "{}");
      if (prompts[oldName]) {
        prompts[newName] = prompts[oldName];
        delete prompts[oldName];
        localStorage.setItem("chatPrompts", JSON.stringify(prompts));
      }

      if (currentChatTitle === oldName) currentChatTitle = newName;
      updateChatList();
    }

    function confirmDelete(name) {
      const confirmBox = document.createElement("div");
      confirmBox.style.position = "fixed";
      confirmBox.style.top = "50%";
      confirmBox.style.left = "50%";
      confirmBox.style.transform = "translate(-50%, -50%)";
      confirmBox.style.background = "white";
      confirmBox.style.border = "1px solid #ccc";
      confirmBox.style.padding = "20px";
      confirmBox.style.borderRadius = "10px";
      confirmBox.style.boxShadow = "0 0 10px rgba(0,0,0,0.2)";
      confirmBox.style.zIndex = "1000";

      confirmBox.innerHTML = `<div style="margin-bottom: 10px;">ëŒ€í™”ë¥¼ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?</div>`;

      const yesBtn = document.createElement("button");
      yesBtn.textContent = "ì˜ˆ";
      yesBtn.style.marginRight = "10px";
      yesBtn.onclick = () => {
        const savedChats = JSON.parse(localStorage.getItem("savedChats") || "{}");
        delete savedChats[name];
        localStorage.setItem("savedChats", JSON.stringify(savedChats));

        const prompts = JSON.parse(localStorage.getItem("chatPrompts") || "{}");
        delete prompts[name];
        localStorage.setItem("chatPrompts", JSON.stringify(prompts));

        updateChatList();
        document.body.removeChild(confirmBox);
      };

      const noBtn = document.createElement("button");
      noBtn.textContent = "ì•„ë‹ˆì˜¤";
      noBtn.onclick = () => {
        document.body.removeChild(confirmBox);
      };

      confirmBox.appendChild(yesBtn);
      confirmBox.appendChild(noBtn);
      document.body.appendChild(confirmBox);
    }

    function setPrompt(chatName) {
      const prompts = JSON.parse(localStorage.getItem("chatPrompts") || "{}");
      const currentPrompt = prompts[chatName] || "";

      const modal = document.createElement("div");
      modal.style.position = "fixed";
      modal.style.top = 0;
      modal.style.left = 0;
      modal.style.width = "100%";
      modal.style.height = "100%";
      modal.style.backgroundColor = "rgba(0,0,0,0.4)";
      modal.style.display = "flex";
      modal.style.justifyContent = "center";
      modal.style.alignItems = "center";
      modal.style.zIndex = 1000;

      const box = document.createElement("div");
      box.style.background = "white";
      box.style.padding = "20px";
      box.style.borderRadius = "20px";
      box.style.boxShadow = "0 4px 10px rgba(0,0,0,0.2)";
      box.style.maxWidth = "600px";
      box.style.width = "90%";
      box.style.display = "flex";
      box.style.flexDirection = "column";
      box.style.gap = "10px";

      const textarea = document.createElement("textarea");
      textarea.value = currentPrompt;
      textarea.placeholder = "í”„ë¡¬í”„íŠ¸ë¥¼ ì…ë ¥í•˜ì„¸ìš”...";
      textarea.style.padding = "12px 18px";
      textarea.style.borderRadius = "20px";
      textarea.style.border = "1px solid #ccc";
      textarea.style.fontSize = "16px";
      textarea.style.lineHeight = "1.5em";
      textarea.style.resize = "none";
      textarea.style.width = "90%";
      textarea.style.height = "120px";
      textarea.style.boxShadow = "0 2px 5px rgba(0,0,0,0.1)";
      textarea.style.outline = "none";

      const buttonRow = document.createElement("div");
      buttonRow.style.display = "flex";
      buttonRow.style.justifyContent = "flex-end";
      buttonRow.style.gap = "10px";

      const cancelBtn = document.createElement("button");
      cancelBtn.textContent = "ì·¨ì†Œ";
      cancelBtn.onclick = () => document.body.removeChild(modal);
      cancelBtn.style.padding = "10px 16px";
      cancelBtn.style.borderRadius = "12px";
      cancelBtn.style.border = "none";
      cancelBtn.style.background = "#eee";
      cancelBtn.style.cursor = "pointer";

      const saveBtn = document.createElement("button");
      saveBtn.textContent = "ì €ì¥";
      saveBtn.onclick = () => {
        prompts[chatName] = textarea.value.trim();
        localStorage.setItem("chatPrompts", JSON.stringify(prompts));
        document.body.removeChild(modal);
      };
      saveBtn.style.padding = "10px 16px";
      saveBtn.style.borderRadius = "12px";
      saveBtn.style.border = "none";
      saveBtn.style.background = "#d1ffd6";
      saveBtn.style.cursor = "pointer";

      buttonRow.appendChild(cancelBtn);
      buttonRow.appendChild(saveBtn);

      box.appendChild(textarea);
      box.appendChild(buttonRow);
      modal.appendChild(box);
      document.body.appendChild(modal);

      // ì™¸ë¶€ í´ë¦­ ì‹œ ë‹«ê¸°
      modal.addEventListener("click", (e) => {
        if (e.target === modal) {
          document.body.removeChild(modal);
        }
      });
    }


    function loadChat(name) {
      const savedChats = JSON.parse(localStorage.getItem("savedChats") || "{}");
      const history = savedChats[name];
      if (!history) return;
      currentChatTitle = name;
      chatHistory = history;
      chatDisplay.innerHTML = "";
      history.forEach(line => {
        const [sender, ...rest] = line.split(": ");
        const content = rest.join(": ");
        if (sender === "You") {
          addMessage("user", content);
        } else if (sender === "Gemini") {
          addMessage("bot", content);
        }
      });
    }

    window.addEventListener("DOMContentLoaded", () => {
      updateChatList();
    });

    async function sendMessage() {
      const message = userInput.value.trim();
      if (!message || isWaitingForResponse) return;

      isWaitingForResponse = true;
      updateChatList();

      addMessage("user", message);
      userInput.value = "";

      chatHistory.push(`You: ${message}`);

      if (!currentChatTitle) {
        currentChatTitle = message.slice(0, 30);
      }
      saveChat();

      addLoading();
      await getBotResponse(message);

      isWaitingForResponse = false;
      updateChatList();
    }

    function escapeHtml(unsafe) {
      return unsafe || ""
        .replace(/&/g, "&amp;")
        .replace(/</g, "&lt;")
        .replace(/>/g, "&gt;")
        .replace(/"/g, "&quot;")
        .replace(/'/g, "&#039;");
    }

    function formatMarkdown(text) {
      const placeholderMap = new Map();
      let placeholderIndex = 0;
      
      // 1ë‹¨ê³„: ì½”ë“œ ë¸”ë¡ì„ ëŒ€ì²´ í…ìŠ¤íŠ¸ë¡œ ì„ì‹œ ì¹˜í™˜í•˜ê³  ì €ì¥
      text = (text || "").replace(/```(\S+)\n([\s\S]*?)```/g, (_, title, content) => {
        const key = `__CODE_BLOCK_${placeholderIndex++}__`;
        placeholderMap.set(key, { title: title.trim(), content: content.trim() });
        return key;
      });

      text = escapeHtml(text);

      // 3. ë§ˆí¬ë‹¤ìš´ í—¤ë”
      text = text || ""
        .replace(/^### (.*$)/gim, '<h3>$1</h3>')
        .replace(/^## (.*$)/gim, '<h2>$1</h2>')
        .replace(/^# (.*$)/gim, '<h1>$1</h1>');

      // 4. ì´ë¯¸ì§€
      text = (text || "").replace(/\{\{(.*?)\}\}/g, (_, filename) => {
        const safeName = filename.trim().replace(/[^a-zA-Z0-9-_]/g, '');
        return `<br><img src="/img/${safeName}.png" alt="${safeName}" class="inline-image"><br>`;
      });

      // 5. í…Œì´ë¸”
      const tableRegex = /((?:^\|.*?\|\s*(?:\n|$))+)/gm;
      text = (text || "").replace(tableRegex, (match) => {
        const rows = match.trim().split('\n').filter(Boolean);
        if (rows.length < 2) return match;

        const header = rows[0].split('|').slice(1, -1).map(h => h.trim());
        const body = rows.slice(2).map(row => row.split('|').slice(1, -1).map(c => c.trim()));

        const thead = '<thead><tr>' + header.map(h => `<th>${h}</th>`).join('') + '</tr></thead>';
        const tbody = '<tbody>' + body.map(row => '<tr>' + row.map(c => `<td>${c}</td>`).join('') + '</tr>').join('') + '</tbody>';

        return `<table class="chat-table">${thead}${tbody}</table>`;
      }) ;

      // 2ë‹¨ê³„: ì‹¤ì œ HTML ë³€í™˜ìœ¼ë¡œ ì¹˜í™˜
      for (const [key, { title, content }] of placeholderMap.entries()) {
        const escaped = escapeHtml(content);
        const safeTitle = escapeHtml(title);
        const html = `
          <div class="file-description-box">
            <div class="file-description-title">${safeTitle}</div>
            <pre class="file-description-content">${escaped}</pre>
          </div>
        `;
        text = text.replace(key, html);
      }

      /*// 5. í‚¤ì›Œë“œ ë¸”ë¡ (ì˜ˆ: ```íŒŒì¼ì„¤ëª…\në‚´ìš©```)
      text = text.replace(/```(\S+)\n([\s\S]*?)```/g, (_, title, content) => {
        const escaped = escapeHtml(content.trim());
        const safeTitle = escapeHtml(title.trim());
        return `
          <div class="file-description-box">
            <div class="file-description-title">${safeTitle}</div>
            <pre class="file-description-content">${escaped}</pre>
          </div>
        `;
      });*/

      return text
        .replace(/\*\*(.*?)\*\*/g, '<strong>$1</strong>')
        .replace(/(^|\s)\*(?!\s)([^\*]+?)\*(?!\*)/g, '$1<em>$2</em>')
        .replace(/^(\s*)\*\s+(.*)$/gm, '$1â€¢ $2')
        .replace(/cmd\[.*?\]/g, '')
        .replace(/\n/g, '<br>');
    }




    function addMessage(sender, message) {
      const messageElem = document.createElement("div");
      messageElem.className = `message ${sender}`;
      const formatted = formatMarkdown(message);
      messageElem.innerHTML = `<div class="bubble">${formatted}</div>`;
      chatDisplay.appendChild(messageElem);
      chatDisplay.scrollTop = chatDisplay.scrollHeight;

      setTimeout(() => {
        messageElem.classList.add("show");
      }, 10);
    }

    function addLoading() {
      const loadingElem = document.createElement("div");
      loadingElem.className = "message bot loading";
      loadingElem.innerHTML = `<div class="bubble"><span class="dots">.</span></div>`;
      chatDisplay.appendChild(loadingElem);
      chatDisplay.scrollTop = chatDisplay.scrollHeight;

      setTimeout(() => {
        loadingElem.classList.add("show");
      }, 10);
    }

    async function getBotResponse(userMessage) {
      try {
        let chatHistoryForAI = chatHistory;
        let fullConversation = '# ëŒ€í™”ê¸°ë¡:\n'+chatHistoryForAI.join("\n");

        const prompts = JSON.parse(localStorage.getItem("chatPrompts") || "{}");
        const currentPrompt = prompts[currentChatTitle] || "";
        
        if (currentPrompt) {
          fullConversation = `# í”„ë¡¬í”„íŠ¸:\n${currentPrompt}\n\n${fullConversation}`;
        }

        fullConversation = `# ëª…ë ¹ì–´:\n${text_commands}\n\n${fullConversation}`

        fullConversation = `# ê¸°ë³¸ê·œì¹™:\n${base_sets}\n\n${fullConversation}`


        while (fullConversation.split(/\s+/).length > 990000) {
          chatHistoryForAI.shift();
          fullConversation = chatHistoryForAI.join("\n");
        }

        const response = await fetch("/genai", {
          method: "POST",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify({ contents: fullConversation })
        });

        const data = await response.json();
        const botReply = data.reply;

        removeLoading();
        chatHistory.push(`Gemini: ${botReply}`);
        addMessage("bot", botReply);
        handleCommandInput(botReply);

        saveChat();

      } catch (error) {
        console.error(error);
        removeLoading();
        addMessage("bot", "Error: " + error.message);
      }
    }

    function removeLoading() {
      const loadingElem = chatDisplay.querySelector(".message.loading");
      if (loadingElem) {
        loadingElem.remove();
      }
    }

    setInterval(() => {
      const dots = document.querySelectorAll(".dots");
      dots.forEach(dot => {
        if (dot.textContent === ".") dot.textContent = "..";
        else if (dot.textContent === "..") dot.textContent = "...";
        else dot.textContent = ".";
      });
    }, 500);

    function autoResizeTextarea(textarea) {
      textarea.style.height = 'auto'; // ë†’ì´ ì´ˆê¸°í™”
      const lineHeight = parseFloat(getComputedStyle(textarea).lineHeight);
      const maxHeight = lineHeight * 10 + 24; // ìµœëŒ€ 10ì¤„ + íŒ¨ë”© ë³´ì •
      const newHeight = Math.min(textarea.scrollHeight, maxHeight);
      textarea.style.height = newHeight + 'px';
    }

    userInput.addEventListener('input', () => autoResizeTextarea(userInput));

    // í˜ì´ì§€ ë¡œë“œì‹œ ì´ˆê¸° ì¡°ì •
    window.addEventListener('DOMContentLoaded', () => {
      autoResizeTextarea(userInput);
    });

    document.getElementById("resendButton").addEventListener("click", () => {
      resendMessage();
    });

    async function resendMessage() {
      if (isWaitingForResponse) return;
      isWaitingForResponse = true;
      chatHistory.pop();
      saveChat();
      loadChat(currentChatTitle);

      addLoading();
      await getBotResponse();

      isWaitingForResponse = false;
      updateChatList();
    }

    //ì‹¤í–‰ëœ ëª…ë ¹ì–´ ë°˜í™˜
    function handleCommandInput(message) {
      if (message == null) return;
      const matches = message.split(/[\n\s]+/);


      matches.forEach(word=> {
        const commandMatch = word.match(/^cmd\[(.+?)\]$/);
        if (commandMatch){
          const fullText = commandMatch[1].trim().toLowerCase();
          const regex = /(\w+)\((.*)\)/;
          const match = fullText.match(regex);
          if (match) {
            const cmd = match[1];
            const value = match[2];
            switch(cmd){
              case "bg":
                const in_sidebar_btns = document.getElementById("sidebar").querySelectorAll('button');
                const in_chat_btns = document.getElementById("chatContainer").querySelectorAll('button');
                switch(value){
                  case "basic":
                    document.body.style.background = 'linear-gradient(135deg, #e0f7fa, #f0f4c3)';
                    in_sidebar_btns.forEach(button123 => {
                        button123.style.color = 'black';
                    });
                    in_chat_btns.forEach(button321 => {
                        button321.style.color = 'black';
                    });
                    break;
                  case "night":
                    document.body.style.background = 'linear-gradient(135deg, #000000, #002a79)';
                    in_sidebar_btns.forEach(button234 => {
                        button234.style.color = 'white';
                    });
                    in_chat_btns.forEach(button432 => {
                        button432.style.color = 'white';
                    });
                    break;
                }
                break;
            }
          }
        }
      })
    }

    window.addEventListener('beforeunload', function(event) {

      if (hasUnsavedChanges) {
        event.preventDefault();
        return 'ì±„íŒ…ì¤‘...';
      }
    });


  </script>
  <style>
    html, body {
      margin: 0;
      padding: 0;
      height: 100%;
      width: 100%;
      background: linear-gradient(135deg, #e0f7fa, #f0f4c3);
      font-family: 'Segoe UI Emoji', 'Noto Color Emoji', 'Apple Color Emoji', sans-serif;
      display: flex;
      overflow: hidden;
    }
    #sidebar {
      width: 220px;
      background: rgba(255, 255, 255, 0.13);
      display: flex;
      flex-direction: column;
      padding: 20px;
      box-shadow: 2px 0 5px rgba(0,0,0,0.1);
    }
    #sidebar button,#resendButton {
      margin-bottom: 10px;
      padding: 10px;
      border: none;
      background: rgba(0, 81, 255, 0.2);
      border-radius: 12px;
      cursor: pointer;
      font-size: 14px;
      height: 40px;
      box-shadow: 2px 0 5px rgba(0,0,0,0.15);
    }
    #resendButton {
      width: auto;
      height: 40px;
      margin-left: 0;
    }
    #main {
      flex: 1;
      display: flex;
      flex-direction: column;
      align-items: center;
      overflow: hidden;
    }
    #titleBar {
      width: 100%;
      max-width: 1000px;
      background: #ffffffcc;
      text-align: center;
      padding: 15px;
      font-size: 20px;
      font-weight: bold;
      box-shadow: 0 2px 5px rgba(0,0,0,0.1);
      border-radius: 0 0 20px 20px;
    }

    #chatDisplay {
      flex: 1;
      width: 100%;
      max-width: 1000px;
      padding: 20px;
      overflow-y: auto;
      display: flex;
      flex-direction: column;
      background: transparent;
    }
    .message {
      display: flex;
      margin: 10px 0;
      opacity: 0;
      transform: translateY(20px);
      transition: all 0.3s ease;
    }
    .message.show {
      opacity: 1;
      transform: translateY(0);
    }
    .message.user {
      align-self: flex-end;
      justify-content: flex-end;
    }
    .message.bot {
      align-self: flex-start;
      justify-content: flex-start;
    }
    .bubble {
      padding: 12px 18px;
      border-radius: 20px;
      background: #e1f5fe;
      box-shadow: 0 2px 5px rgba(0,0,0,0.2);
      font-size: 16px;
      overflow-wrap: break-word;
      word-break: break-word;
      max-width: 80ch;
      tab-size: 4;
      -moz-tab-size: 4;
      -o-tab-size: 4;
      white-space: pre-wrap; /* ì¤‘ìš”: ì¤„ë°”ê¿ˆ + íƒ­ ìœ ì§€ */
    }

    .message.user .bubble {
      background: #d1ffd6;
    }
    #inputArea {
      width: 100%;
      max-width: 1000px;
      display: flex;
      padding: 10px 20px;
      background: transparent;
      border-top: none;
    }
    #userInput {
      flex: 1;
      padding: 12px 18px;
      font-size: 16px;
      border-radius: 20px;
      border: 1px solid #ccc;
      outline: none;
      background: #ffffff;
      box-shadow: 0 2px 5px rgba(0,0,0,0.1);
      white-space: pre-wrap;
      resize: none;
      overflow-y: auto; /* ìŠ¤í¬ë¡¤ í—ˆìš© */
      line-height: 1.5em;
      max-height: calc(1.5em * 10 + 24px); /* 10ì¤„ + padding ë³´ì • */
    }


    #chatList {
      display: flex;
      flex-direction: column;
    }
    
    table.chat-table {
      border-collapse: collapse;
      margin-top: 8px;
      width: fit-content;
      max-width: 100%;
      font-size: 15px;
      background-color: transparent;
      border: 1px solid rgba(0, 0, 0, 0.1);
      border-radius: 12px;
      overflow: hidden;
    }
    table.chat-table th,
    table.chat-table td {
      border: 1px solid rgba(0, 0, 0, 0.1);
      padding: 6px 12px;
      text-align: center;
    }
    table.chat-table th {
      background-color: rgba(255, 255, 255, 0.1);
      font-weight: bold;
    }

    /* ê³µí†µ ìŠ¤í¬ë¡¤ë°” ìŠ¤íƒ€ì¼ */
    * {
      scrollbar-width: thin; /* Firefoxìš© */
      scrollbar-color: #8f8f8f transparent; /* Firefoxìš© */
    }

    /* Webkit ê¸°ë°˜ ë¸Œë¼ìš°ì €ìš© */
    ::-webkit-scrollbar {
      width: 8px;
      height: 8px;
    }

    ::-webkit-scrollbar-track {
      background: transparent;
      border-radius: 10px;
    }

    ::-webkit-scrollbar-thumb {
      background-color: #8f8f8f;
      border-radius: 10px;
      border: 2px solid transparent;
      background-clip: content-box;
      transition: background-color 0.3s ease;
    }

    ::-webkit-scrollbar-thumb:hover {
      background-color: #8f8f8f;
    }

    ::-webkit-scrollbar-corner {
      background: transparent;
    }

    .file-description-box {
      background-color: rgba(0, 0, 0, 0.1);
      color: #00106b;
      border-radius: 6px;
      padding: 1em;
      margin: 1em 0;
      font-family: monospace;
    }

    .file-description-title {
      font-weight: bold;
      margin-bottom: 0.5em;
      color: #657000;
    }

    .file-description-content {
      white-space: pre-wrap;
    }


  </style>
</head>
<body>
  <div id="sidebar">
    <button id="newChat">ìƒˆ ëŒ€í™”</button>
    <div id="chatList"></div>
  </div>
  <div id="main">
    <div id="chatDisplay"></div>
    <div id="inputArea">
      <textarea id="userInput" rows="1" placeholder="Type a message..."></textarea>
      <button id="resendButton" title="ë‹¤ì‹œ ë³´ë‚´ê¸°">ğŸ”„</button>
    </div>
  </div>
</body>
</html>
